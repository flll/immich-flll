# サポートされているすべての環境変数のドキュメントは https://docs.immich.app/install/environment-variables で確認できます

# アップロードされたファイルが保存される場所
UPLOAD_LOCATION=./library

# データベースファイルが保存される場所。ネットワーク共有はデータベースではサポートされていません
DB_DATA_LOCATION=./postgres

# 使用するImmichのバージョン。"v1.71.0"のような特定のバージョンに固定することができます(デフォルトは"release")
IMMICH_VERSION=v2.1.0

# postgresの接続シークレット。ランダムなパスワードに変更してください
# 特殊文字やスペースを使わず、`A-Za-z0-9`の文字のみを使用してください
DB_PASSWORD=your_secure_password_here

# =============================================================================
# Google Cloud Run設定（ローカルML使用時はコメントアウト）
# =============================================================================
# CLOUD_RUN_ML_URL=https://your-cloud-run-url.run.app

# =============================================================================
# Tailscale関連
# =============================================================================
TS_HOSTNAME=immich
NC_DOMAIN=your-domain.ts.net
TS_AUTH_KEY=your_tailscale_auth_key_here
TS_EXTRA_ARGS=--advertise-tags=tag:immich


# =============================================================================
# 一般的な設定
# =============================================================================

# 環境設定（production, development）
IMMICH_ENV=production

# ログレベル設定（verbose, debug, log, warn, error）
# デフォルト: log
IMMICH_LOG_LEVEL=log

# Immichサーバーで利用可能なCPUコア数
CPU_CORES=auto

# 信頼できるプロキシのIPアドレス（カンマ区切り）
# リバースプロキシを使用している場合に設定
IMMICH_TRUSTED_PROXIES=127.0.0.1,100.64.0.0/10

# =============================================================================
# ポート設定
# =============================================================================

# リスニングホスト（デフォルト: 0.0.0.0）
IMMICH_HOST=0.0.0.0

# リスニングポート（サーバー: 2283, マシンラーニング: 3003）
IMMICH_PORT=80


# =============================================================================
# データベース設定（詳細）
# =============================================================================

# データベースベクトル拡張（vectorchord, pgvector, pgvecto.rs）
# 複数がインストールされている場合、優先順位: VectorChord > pgvecto.rs > pgvector
DB_VECTOR_EXTENSION=vectorchord


# ストレージタイプ最適化（SSD, HDD）
# SSD: 同時IO、HDD: シーケンシャルIO
DB_STORAGE_TYPE=HDD

# =============================================================================
# マシンラーニング設定（詳細）
# =============================================================================

# モデルの非アクティブ時間（秒）- 0以下で無効化
# デフォルト: 300
MACHINE_LEARNING_MODEL_TTL=20

# モデルTTLチェック間隔（秒）- 0以下で無効化
# デフォルト: 10
MACHINE_LEARNING_MODEL_TTL_POLL_S=0

# リクエストスレッドプールのスレッド数（0以下で無効化）
# デフォルト: CPUコア数
MACHINE_LEARNING_REQUEST_THREADS=16

# 並列モデル操作数
# デフォルト: 1
MACHINE_LEARNING_MODEL_INTER_OP_THREADS=4

# 各モデル操作のスレッド数
# デフォルト: 2
MACHINE_LEARNING_MODEL_INTRA_OP_THREADS=8

# ワーカープロセス数（各プロセスがメモリ内でモデルを複製するため注意）
# デフォルト: 1
MACHINE_LEARNING_WORKERS=8

# HTTP Keep-alive時間（秒）
# デフォルト: 2
MACHINE_LEARNING_HTTP_KEEPALIVE_TIMEOUT_S=2

# ワーカーの最大無応答時間（秒）
# デフォルト: 120（OpenVINO使用時は300）
# MACHINE_LEARNING_WORKER_TIMEOUT=120

# この行より下の値は変更する必要がありません
###################################################################################
DB_USERNAME=postgres
DB_DATABASE_NAME=immich
TZ=Asia/Tokyo
LD_LIBRARY_PATH=/usr/local/nvidia/lib64
IMMICH_MACHINE_LEARNING_URL=http://127.0.0.1:3003

